window.__require=function t(e,i,s){function n(c,r){if(!i[c]){if(!e[c]){var u=c.split("/");if(u=u[u.length-1],!e[u]){var a="function"==typeof __require&&__require;if(!r&&a)return a(u,!0);if(o)return o(u,!0);throw new Error("Cannot find module '"+c+"'")}}var h=i[c]={exports:{}};e[c][0].call(h.exports,function(t){return n(e[c][1][t]||t)},h,h.exports,t,e,i,s)}return i[c].exports}for(var o="function"==typeof __require&&__require,c=0;c<s.length;c++)n(s[c]);return n}({Config:[function(t,e,i){"use strict";cc._RF.push(e,"ddc00XrFbZPpoCPw0MZmQD7","Config"),cc.Class({extends:t("Subscriber"),properties:{},onLoad:function(){this.node.Config={LAYER:{LOBBY:1,GAME:2},ROOM_KIND:{CLASSIC:1,ARCADE:2}}}}),cc._RF.pop()},{Subscriber:"Subscriber"}],CutItem:[function(t,e,i){"use strict";cc._RF.push(e,"59727MW9EpAC5/ElxbBO8cv","CutItem");t("EventCode");(function(t){if(null==t)throw new TypeError("Cannot destructure undefined")})(t("Utils")),cc.Class({extends:t("Subscriber"),properties:{},onLoad:function(){this._super(),this.node.removeCutItem=this.removeCutItem.bind(this),this.node.initObj=this.initObj.bind(this)},initObj:function(t){this.node.setPosition(t)},removeCutItem:function(){this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.fadeOut(.1),cc.removeSelf()))},onCollisionEnter:function(t){var e=t.getComponent("VirusItem");e&&!e.isDie&&e.onDie()}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber",Utils:"Utils"}],CutLayer:[function(t,e,i){"use strict";cc._RF.push(e,"962b4ZxJ4RJ8qCXTey6Nhfp","CutLayer");t("EventCode");(function(t){if(null==t)throw new TypeError("Cannot destructure undefined")})(t("Utils")),cc.Class({extends:t("Subscriber"),properties:{cutItem:cc.Prefab,touchPos:cc.v2(0,0)},onLoad:function(){this._super(),this.initEvents(),this.initObj()},initEvents:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onUserStartTouch,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onUserMoveTouch,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onUserEndTouch,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onUserEndTouch,this),cc.sys.isNative||this.node.on(cc.Node.EventType.MOUSE_MOVE,this.onUserMoveTouch,this)},initObj:function(){this.touchPos=cc.v2(0,0),this.listCutItem=[],this.currentCutItem=null},onUserStartTouch:function(t){this.updatePos(t),this.currentCutItem=this.createCutItem(this.touchPos)},onUserMoveTouch:function(t){this.updatePos(t),this.currentCutItem&&this.currentCutItem.setPosition(this.touchPos)},onUserEndTouch:function(t){this.currentCutItem.removeCutItem(),this.currentCutItem=null},updatePos:function(t){var e=t?t.getLocation():null;this.touchPos=e?this.node.convertToNodeSpaceAR(e):this.realPos},createCutItem:function(t){var e=cc.instantiate(this.cutItem);return e.parent=this.node,this.listCutItem.push(e),e.initObj(t),e}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber",Utils:"Utils"}],DataStore:[function(t,e,i){"use strict";cc._RF.push(e,"282fff5VqlLwKPEkDdQHkLF","DataStore");var s=t("Utils").randomInt;cc.Class({extends:t("Subscriber"),properties:{},onLoad:function(){this.node.DataStore=this,this.currentRoom=null,this.currentLayer=null,this.score=0,this.remaining=3,this.isPaused=!1},maxItemToLaunch:function(){return this.score<6?1:this.score<50?3:this.score<150?5:this.score<300?7:s(4,10)},maxBombToLaunch:function(){return this.score<6?0:this.score<50?1:this.score<100?2:this.score<150?3:4},bombProbability:function(){return this.score<5?0:50==this.score?.01:this.score<100?.1:.3}}),cc._RF.pop()},{Subscriber:"Subscriber",Utils:"Utils"}],EffectLayerBottom:[function(t,e,i){"use strict";cc._RF.push(e,"464c6pzaAxBorOrayoXck0M","EffectLayerBottom");var s=t("EventCode"),n=t("Utils").randomInt;cc.Class({extends:t("Subscriber"),properties:{bloodPrefab:cc.Prefab},onLoad:function(){this._super()},initEvents:function(){this.registerEvent(s.GAME_LAYER.ON_RESET_ON_EXIT,this.resetOnExit,this),this.registerEvent(s.EFFECT_LAYER.PLAY_EFFECT_BLOOD,this.effectBlood,this)},effectBlood:function(t){var e=cc.instantiate(this.bloodPrefab);e.parent=this.node,e.setPosition(t),e.angle=n(0,360),e.runAction(cc.sequence(cc.fadeOut(1),cc.removeSelf()))},resetOnExit:function(){for(var t=0;t<this.node.childrenCount;t++)this.node.children[t].stopAllActions(),this.node.children[t].runAction(cc.sequence(cc.fadeOut(.1),cc.removeSelf()))}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber",Utils:"Utils"}],EffectLayerTop:[function(t,e,i){"use strict";cc._RF.push(e,"7b88cwmHxVKhpa5AaM+MHwM","EffectLayerTop");t("EventCode");cc.Class({extends:t("Subscriber"),properties:{},onLoad:function(){this._super()},initEvents:function(){}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber"}],EventCode:[function(t,e,i){"use strict";cc._RF.push(e,"1df68IRyzFMBqhpCRKukX0o","EventCode");e.exports={SOUND:{GET_CONFIG_SOUND:"GET_CONFIG_SOUND",FX_CLICK:"FX_CLICK"},COMMON:{CHANGE_LAYER:"CHANGE_LAYER"},GAME_LAYER:{ON_SHOW_GAME_LAYER:"ON_SHOW_GAME_LAYER",ON_INIT_VIRUS:"ON_INIT_VIRUS",ON_CLEAR_ALL_VIRUS:"ON_CLEAR_ALL_VIRUS",ON_START_MODE_CLASSIC:"ON_START_MODE_CLASSIC",ON_START_MODE_ARRCADE:"ON_START_MODE_ARRCADE",ON_RESET_ON_EXIT:"ON_GAME_RESET_ON_EXIT"},EFFECT_LAYER:{PLAY_EFFECT_BLOOD:"PLAY_EFFECT_BLOOD"},UI_LAYER:{ON_INIT_TIMER:"ON_INIT_TIMER",ON_START_TIMER:"ON_START_TIMER",ON_INIT_REMAINING:"ON_INIT_REMAINING",ON_UPDATE_REMAINING:"ON_UPDATE_REMAINING",ON_INIT_SCORE:"ON_INIT_SCORE",ON_UPDATE_SCORE:"ON_UPDATE_SCORE",ON_START_COUNT_DOWN:"ON_START_COUNT_DOWN"},LOBBY_LAYER:{ON_SHOW_LOBBY_LAYER:"ON_SHOW_LOBBY_LAYER"},POPUP_LAYER:{SHOW_POPUP:"SHOW_POPUP",HIDE_POPUP:"HIDE_POPUP",INIT_SETTING:"INIT_SETTING",SHOW_PAUSE:"SHOW_PAUSE",SHOW_SETTING:"SHOW_SETTING",SHOW_SUMMARY:"SHOW_SUMMARY"}},cc._RF.pop()},{}],"Game\bController":[function(t,e,i){"use strict";cc._RF.push(e,"d89e7mnU2hKTKV5PGJTuhup","Game\bController");var s=t("EventCode");cc.Class({extends:t("Subscriber"),properties:{},onLoad:function(){this._super()},initEvents:function(){this.registerEvent(s.GAME_LAYER.ON_SHOW_GAME_LAYER,this.onShow,this),this.registerEvent(s.GAME_LAYER.ON_START_MODE_CLASSIC,this.startGameModeClassic,this),this.registerEvent(s.GAME_LAYER.ON_START_MODE_ARRCADE,this.startGameModeArcade,this),this.registerEvent(s.GAME_LAYER.ON_RESET_ON_EXIT,this.resetOnExit,this)},onShow:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.node.active=t,this.node.opacity=t?255:0,t&&(this.DataStore.currentLayer=this.Config.LAYER.GAME)},startGameModeClassic:function(){var t=this;this.DataStore.currentRoom=this.Config.ROOM_KIND.CLASSIC,this.emitEvent(s.UI_LAYER.ON_INIT_REMAINING),this.emitEvent(s.UI_LAYER.ON_INIT_SCORE),this.emitEvent(s.UI_LAYER.ON_START_COUNT_DOWN,function(){t.emitEvent(s.GAME_LAYER.ON_INIT_VIRUS)})},startGameModeArcade:function(){var t=this;this.DataStore.currentRoom=this.Config.ROOM_KIND.ARCADE,this.emitEvent(s.UI_LAYER.ON_INIT_TIMER),this.emitEvent(s.UI_LAYER.ON_INIT_SCORE),this.emitEvent(s.UI_LAYER.ON_START_COUNT_DOWN,function(){t.emitEvent(s.UI_LAYER.ON_START_TIMER),t.emitEvent(s.GAME_LAYER.ON_INIT_VIRUS)})},resetOnExit:function(){this.emitEvent(s.UI_LAYER.ON_INIT_SCORE),this.emitEvent(s.GAME_LAYER.ON_CLEAR_ALL_VIRUS)}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber"}],LoadingScene:[function(t,e,i){"use strict";cc._RF.push(e,"45113IsU09CELPNUiNF2EZC","LoadingScene"),cc.Class({extends:cc.Component,properties:{sceneName:"",processBar:cc.Node},onLoad:function(){var t=this;if(""!==this.sceneName){var e=this.sceneName;this.node.active=!0,this.node.opacity=255,cc.director.preloadScene(e,function(e,i,s){var n=0;if(i>0&&(n=100*e/i),n<100&&t.processBar&&t.processBar.getComponent){var o=t.processBar.getComponent(cc.ProgressBar);o.progress=Math.max(o.progress,n/100)}},function(t){cc.director.loadScene(e)})}}}),cc._RF.pop()},{}],LobbyController:[function(t,e,i){"use strict";cc._RF.push(e,"bc007eBJNRCpZOzWBAYYVt5","LobbyController");var s=t("EventCode");cc.Class({extends:t("Subscriber"),properties:{},onLoad:function(){this._super()},initEvents:function(){this.node.registerEvent(s.LOBBY_LAYER.ON_SHOW_LOBBY_LAYER,this.onShow,this)},onShow:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.node.active=t,this.node.opacity=t?255:0,t&&(this.DataStore.currentLayer=this.Config.LAYER.LOBBY)},onBtnSettingClick:function(){cc.log("::LobbyLayer:: onBtnSettingClick"),this.node.Sound.playSFXClick(),this.emitEvent(s.POPUP_LAYER.SHOW_SETTING)},onRoomClassicClick:function(){cc.log("::LobbyLayer:: onRoomClassicClick"),this.node.Sound.playSFXClick(),this.emitEvent(s.COMMON.CHANGE_LAYER,this.Config.LAYER.GAME),this.emitEvent(s.GAME_LAYER.ON_START_MODE_CLASSIC)},onRoomArcadeClick:function(){cc.log("::LobbyLayer:: onRoomArcadeClick"),this.node.Sound.playSFXClick(),this.emitEvent(s.COMMON.CHANGE_LAYER,this.Config.LAYER.GAME),this.emitEvent(s.GAME_LAYER.ON_START_MODE_ARRCADE)}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber"}],MainGameDirector:[function(t,e,i){"use strict";cc._RF.push(e,"0e31cq6/UtMtZrM/3jMUcYh","MainGameDirector");var s=t("EventCode");cc.Class({extends:t("Subscriber"),properties:{},onLoad:function(){var t=this;cc.director.getCollisionManager().enabled=!0,this._super(),setTimeout(function(){t.changeLayer(t.Config.LAYER.LOBBY),t.initEvents()},50)},initEvents:function(){this.node.registerEvent(s.COMMON.CHANGE_LAYER,this.changeLayer,this)},changeLayer:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.Config.LAYER.LOBBY)==this.Config.LAYER.LOBBY;this.emitEvent(s.LOBBY_LAYER.ON_SHOW_LOBBY_LAYER,t),this.emitEvent(s.GAME_LAYER.ON_SHOW_GAME_LAYER,!t)}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber"}],Observer:[function(t,e,i){"use strict";cc._RF.push(e,"95aa1Omhv5Bu7a5bpVvBOV/","Observer"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node._observer=this,this.node.DataStore||cc.error("PLEASE ATTACH THE 'dataStore' !!!!!!!! "),this.node.Config||cc.error("PLEASE ATTACH THE 'Config' !!!!!!!! "),this.node.Sound||cc.error("PLEASE ATTACH THE 'Sound' !!!!!!!! ")},unsubscribe:function(t,e,i){this.node.off(t,e,i)},subscribe:function(t,e,i){this.node.on(t,e,i)},emitEvent:function(t,e){this.node.emit(t,e)}}),cc._RF.pop()},{}],PausePopup:[function(t,e,i){"use strict";cc._RF.push(e,"06033H3TwlNErqfmUrkFvJq","PausePopup");var s=t("EventCode");cc.Class({extends:t("PopupItem"),properties:{},onLoad:function(){this._super()},initEvents:function(){this._super(),this.registerEvent(s.POPUP_LAYER.SHOW_PAUSE,this.onShow,this)},onShow:function(){this._super(),this.DataStore.isPaused=!0},onHide:function(){this._super(),this.DataStore.isPaused=!1},onBackToLobby:function(){this.node.Sound.playSFXClick(),this.onHide(),this.emitEvent(s.COMMON.CHANGE_LAYER,this.Config.LAYER.LOBBY),this.emitEvent(s.GAME_LAYER.ON_RESET_ON_EXIT)}}),cc._RF.pop()},{EventCode:"EventCode",PopupItem:"PopupItem"}],PopupController:[function(t,e,i){"use strict";cc._RF.push(e,"c852253V1dA8IYLRIV/qe9d","PopupController");t("EventCode");cc.Class({extends:t("Subscriber"),properties:{},onLoad:function(){this._super()}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber"}],PopupItem:[function(t,e,i){"use strict";cc._RF.push(e,"4a6adgrx7pGGps2FWwgz9ia","PopupItem");var s=t("EventCode");cc.Class({extends:t("Subscriber"),properties:{overlay:cc.Node,container:cc.Node},onLoad:function(){this._super(),this.fadeSpeed=.2,this.isShowing=!1,this.node.opacity=0,this.overlay.active=!1,this.container.active=!1},initEvents:function(){this.registerEvent(s.POPUP_LAYER.SHOW_POPUP,this.onShow,this),this.registerEvent(s.POPUP_LAYER.HIDE_POPUP,this.onHide,this)},onShow:function(){this.isShowing=!0,this.node.active=!0,this.overlay.active=!0,this.container.active=!0,this.node.runAction(cc.fadeIn(this.fadeSpeed))},onHide:function(){var t=this;this.isShowing=!1,this.node.runAction(cc.sequence(cc.fadeOut(this.fadeSpeed),cc.callFunc(function(){t.node.active=!1,t.overlay.active=!1,t.container.active=!1})))}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber"}],Remaining:[function(t,e,i){"use strict";cc._RF.push(e,"7f91d7BLutCSqLiQN0y3AK9","Remaining");var s=t("EventCode"),n=cc.Class({name:"remainingAssetVirus",properties:{name:{default:""},static:{type:cc.SpriteFrame,default:null}}});cc.Class({extends:t("Subscriber"),properties:{listRemaning:[cc.Node],asset:{default:[],type:[n]}},onLoad:function(){this._super(),this.initEvents()},initEvents:function(){this.registerEvent(s.UI_LAYER.ON_INIT_REMAINING,this.initObj,this),this.registerEvent(s.UI_LAYER.ON_UPDATE_REMAINING,this.updateRemaining,this)},initObj:function(){var t=this;this.DataStore.remaining=3,this.listRemaning.forEach(function(e){var i=t.findStaticData("WIN");e.getComponent(cc.Sprite).spriteFrame=i.static})},updateRemaining:function(){this.DataStore.remaining--;for(var t=Math.max(0,3-this.DataStore.remaining),e=0;e<t;e++){var i=this.findStaticData("LOSE");this.listRemaning[e].getComponent(cc.Sprite).spriteFrame=i.static}0==this.DataStore.remaining&&(this.emitEvent(s.POPUP_LAYER.SHOW_SUMMARY),this.emitEvent(s.GAME_LAYER.ON_CLEAR_ALL_VIRUS))},findStaticData:function(t){for(var e=0;e<this.asset.length;e++)if(this.asset[e].name==t)return this.asset[e];return null}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber"}],SettingPopup:[function(t,e,i){"use strict";cc._RF.push(e,"424f0h5NwpDD6cLr4L08KP7","SettingPopup");var s=t("EventCode");cc.Class({extends:t("PopupItem"),properties:{SFXCheckBox:cc.Node,BGMCheckBox:cc.Node},onLoad:function(){this._super(),this.SFXCheckBox.on("toggle",this.sfxToggle.bind(this),this),this.BGMCheckBox.on("toggle",this.bgmToggle.bind(this),this),this.BGMCheckBox.getComponent(cc.Toggle).isChecked=!1,this.SFXCheckBox.getComponent(cc.Toggle).isChecked=!1,this.node.Sound&&this.node.Sound.isEnableBGM&&(this.BGMCheckBox.getComponent(cc.Toggle).check(),this.node.Sound.playMainBGM()),this.node.Sound&&this.node.Sound.isEnableSFX&&this.SFXCheckBox.getComponent(cc.Toggle).check(),this.initialized=!0},initEvents:function(){this._super(),this.node.registerEvent(s.POPUP_LAYER.SHOW_SETTING,this.onShow,this)},onShow:function(){this._super()},sfxToggle:function(){this.node.Sound.setEffectEnable(this.SFXCheckBox.getComponent(cc.Toggle).isChecked),this.node.Sound.playSFXClick()},bgmToggle:function(){this.node.Sound.playSFXClick(),this.node.Sound.setBgmEnable(this.BGMCheckBox.getComponent(cc.Toggle).isChecked)}}),cc._RF.pop()},{EventCode:"EventCode",PopupItem:"PopupItem"}],SoundController:[function(t,e,i){"use strict";cc._RF.push(e,"617c2h78WRP/4XbzuUWIDyN","SoundController"),cc.Class({extends:t("WebSoundPlayer").WebSoundPlayer,properties:{},onLoad:function(){this.node.Sound=this,this._super()}}),cc._RF.pop()},{WebSoundPlayer:"WebSoundPlayer"}],SoundPlayer:[function(t,e,i){"use strict";cc._RF.push(e,"abc89kDKm1BWqiL1SMgYh30","SoundPlayer");cc.audioEngine.AudioState;cc.Class({extends:cc.Component,properties:{sfxClick:{default:null,type:cc.AudioClip},bgmMain:{default:null,type:cc.AudioClip},storageKeyBGM:"enableBackgroundMusic",storageKeySFX:"enableSound"},onLoad:function(){this.setDefaultVolume(),this.isEnableBGM=!1,this.isEnableSFX=!1,this.node.on("PLAY_SOUND",this.playSound,this),this.node.on("STOP_SOUND",this.stopSound,this),this.node.on("PLAY_CLICK",this.playSFXClick,this),this.node.on("PLAY_SFX",this.playSFX,this),this.emit=this.node.emit,this.node.soundPlayer=this,this.isEnableBGM=cc.sys.localStorage.getItem(this.storageKeyBGM),this.isEnableSFX=cc.sys.localStorage.getItem(this.storageKeySFX),this.isEnableBGM=null==this.isEnableBGM||JSON.parse(this.isEnableBGM),this.isEnableSFX=null==this.isEnableSFX||JSON.parse(this.isEnableSFX),this.onExtendedLoad()},setDefaultVolume:function(){var t=this.node.config||{},e=t.MUSIC_VOLUME,i=t.SOUND_EFFECT_VOLUME;this.MUSIC_VOLUME=e||.5,this.SOUND_EFFECT_VOLUME=i||1,cc.audioEngine.setEffectsVolume(this.SOUND_EFFECT_VOLUME),cc.audioEngine.setMusicVolume(this.MUSIC_VOLUME)},onExtendedLoad:function(){},start:function(){},sfxToggle:function(){this.isEnableSFX=!this.isEnableSFX,this.node.gSlotDataStore&&(this.node.gSlotDataStore.isEnableSFX=this.isEnableSFX),cc.sys.localStorage.setItem(this.storageKeySFX,this.isEnableSFX),this.isEnableSFX||cc.audioEngine.stopAllEffects()},bgmToggle:function(){this.isEnableBGM=!this.isEnableBGM,this.node.gSlotDataStore&&(this.node.gSlotDataStore.isEnableBGM=this.isEnableBGM),cc.sys.localStorage.setItem(this.storageKeyBGM,this.isEnableBGM),this.isEnableBGM?this.playMainBGM():cc.audioEngine.pauseMusic()},playMusic:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.MUSIC_VOLUME;this.isEnableBGM&&(cc.audioEngine.isMusicPlaying()&&this.currentBGM===t||(cc.audioEngine.playMusic(t,e),cc.audioEngine.setMusicVolume(i),this.currentBGM=t))},playSFXClick:function(){this.isEnableSFX&&cc.audioEngine.playEffect(this.sfxClick)},playSFX:function(t){if(this.isEnableSFX)return cc.audioEngine.playEffect(t)},playMainBGM:function(){this.isEnableBGM&&this.playMusic(this.bgmMain,!0)},playSound:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.SOUND_EFFECT_VOLUME;if(this.isEnableSFX)return cc.audioEngine.play(t,e,i)},stopSound:function(t){cc.audioEngine.stop(t)},stopAllAudio:function(){cc.audioEngine.stopAll()}}),cc._RF.pop()},{}],Subscriber:[function(t,e,i){"use strict";cc._RF.push(e,"0fd03uMMxlPSoCaiBFwIbXw","Subscriber"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.unsubscribe=this.unsubscribe.bind(this),this.node.registerEvent=this.registerEvent.bind(this),this.node.emitEvent=this.emitEvent.bind(this),this.DataStore=this.node.DataStore=this.getDataStore(),this.Config=this.node.Config=this.getConfig(),this.Sound=this.node.Sound=this.getSound()},start:function(){this.initEvents()},initEvents:function(){},_getRefObserver:function(){if(!this.node._observer){for(var t=null,e=this.node;!t&&e;)(e=e.parent)._observer&&(t=e._observer);this.node._observer=t,this.node._observer||cc.warn("Observer doesnt exist in node tree!!")}return this.node._observer},unsubscribe:function(t,e,i){t&&this._getRefObserver().unsubscribe(t,e,i)},registerEvent:function(t,e,i){t?t&&this._getRefObserver().subscribe(t,e,i):cc.warn("Cannot find eventCode:",t," to register. Please check EventCode")},emitEvent:function(t,e){t?t&&this._getRefObserver().emitEvent(t,e):cc.warn("Cannot find event code",t,"to fire. Please check EventCode")},getDataStore:function(){return this._getRefObserver().node.DataStore},getConfig:function(){return this._getRefObserver().node.Config},getSound:function(){return this._getRefObserver().node.Sound}}),cc._RF.pop()},{}],SummaryPopup:[function(t,e,i){"use strict";cc._RF.push(e,"56321LVcJ1NOKIEjjv5EqNE","SummaryPopup");var s=t("EventCode");cc.Class({extends:t("PopupItem"),properties:{score:cc.Node,bestScore:cc.Node},onLoad:function(){this._super()},initEvents:function(){this._super(),this.registerEvent(s.POPUP_LAYER.SHOW_SUMMARY,this.onShow,this)},onShow:function(){this._super(),this.score.getComponent(cc.Label).string=this.DataStore.score},onHide:function(){this._super()},onBackToLobby:function(){this.node.Sound.playSFXClick(),this.onHide(),this.emitEvent(s.COMMON.CHANGE_LAYER,this.Config.LAYER.LOBBY),this.emitEvent(s.GAME_LAYER.ON_RESET_ON_EXIT)},onReplay:function(){this.node.Sound.playSFXClick(),this.onHide(),this.emitEvent(s.GAME_LAYER.ON_RESET_ON_EXIT),this.DataStore.currentRoom==this.Config.ROOM_KIND.ARCADE?this.emitEvent(s.GAME_LAYER.ON_START_MODE_ARRCADE):this.emitEvent(s.GAME_LAYER.ON_START_MODE_CLASSIC)}}),cc._RF.pop()},{EventCode:"EventCode",PopupItem:"PopupItem"}],Timer:[function(t,e,i){"use strict";cc._RF.push(e,"df637kJ0uJEvZXhVLxv9/2Z","Timer");var s=t("EventCode");cc.Class({extends:t("Subscriber"),properties:{},onLoad:function(){this._super()},initEvents:function(){this.registerEvent(s.UI_LAYER.ON_INIT_TIMER,this.initObj,this),this.registerEvent(s.UI_LAYER.ON_START_TIMER,this.startTimer,this)},initObj:function(){this.countTime=60,this.node.getComponent(cc.Label).string=60,this.node.stopAllActions()},startTimer:function(){var t=this;this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){t.DataStore.isPaused||(t.countTime--,t.node.getComponent(cc.Label).string=t.countTime,0==t.countTime&&(t.node.stopAllActions(),t.emitEvent(s.POPUP_LAYER.SHOW_SUMMARY),t.emitEvent(s.GAME_LAYER.ON_CLEAR_ALL_VIRUS)))}))).repeatForever()}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber"}],UIController:[function(t,e,i){"use strict";cc._RF.push(e,"7e454aCLZFDcq+6u5nKapzd","UIController");var s=t("EventCode");cc.Class({extends:t("Subscriber"),properties:{scoreTxt:cc.Node,remainingUI:cc.Node,timerUI:cc.Node,countDownUI:cc.Node},onLoad:function(){this._super()},initEvents:function(){this.registerEvent(s.UI_LAYER.ON_UPDATE_SCORE,this.onUpdateScore,this),this.registerEvent(s.UI_LAYER.ON_INIT_SCORE,this.onInitScore,this),this.registerEvent(s.GAME_LAYER.ON_START_MODE_ARRCADE,this.changeUIArrcadeMode,this),this.registerEvent(s.GAME_LAYER.ON_START_MODE_CLASSIC,this.changeUIClassicMode,this),this.registerEvent(s.UI_LAYER.ON_START_COUNT_DOWN,this.onStartCountDown,this)},changeUIArrcadeMode:function(){this.remainingUI.active=!1,this.timerUI.active=!0},changeUIClassicMode:function(){this.remainingUI.active=!0,this.timerUI.active=!1},onInitScore:function(){this.DataStore.score=0,this.scoreTxt.getComponent(cc.Label).string=this.DataStore.score},onUpdateScore:function(){this.DataStore.score++,this.scoreTxt.getComponent(cc.Label).string=this.DataStore.score},onStartCountDown:function(t){var e=this,i=3;this.countDownUI.getComponent(cc.Label).string=i,this.countDownUI.stopAllActions(),this.countDownUI.active=!0,this.countDownUI.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){e.DataStore.isPaused||(-1==--i&&(e.countDownUI.stopAllActions(),e.countDownUI.active=!1,t()),e.countDownUI.getComponent(cc.Label).string=i)}))).repeatForever()},onBtnPauseClick:function(){this.node.Sound.playSFXClick(),this.emitEvent(s.POPUP_LAYER.SHOW_PAUSE)}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber"}],Utils:[function(t,e,i){"use strict";cc._RF.push(e,"09ed6wQoLxOE56t6dHVv+vZ","Utils"),e.exports={randomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},randomFloat:function(t,e){return Math.random()*(e-t)+t}},cc._RF.pop()},{}],VirusItem:[function(t,e,i){"use strict";cc._RF.push(e,"f8de23SP4hNHJCC3nR0wg19","VirusItem");var s=t("EventCode"),n=t("Utils"),o=n.randomInt,c=n.randomFloat;cc.Class({extends:t("Subscriber"),properties:{main:cc.Node,half_1:cc.Node,half_2:cc.Node},onLoad:function(){this._super(),this.initData(),this.node.launchVirus=this.launchVirus.bind(this),this.node.onDie=this.onDie.bind(this)},initData:function(){this.main.active=!0,this.half_1.active=!1,this.half_2.active=!1,this.created=!1,this.node.opacity=0,this.isDie=!1},launchVirus:function(){var t=cc.v2(o(-450,450),-150),e=Math.abs(Math.abs(t.x)+o(-50,50));this.velocity=cc.v2(e/2,o(600,650)),this.gravity=cc.v2(0,-this.velocity.y/2),this.speed=c(1,1.5),this.node.setPosition(t.x,t.y),this.posStart=this.node.getPosition(),this.created=!0,this.node.opacity=255},update:function(t){this.created&&!this.DataStore.isPaused&&(t*=this.speed,this.posStart.x<0?this.node.x=this.node.x+this.velocity.x*t:this.node.x=this.node.x-this.velocity.x*t,this.node.y=this.node.y+this.velocity.y*t,this.velocity.x=this.velocity.x+this.gravity.x*t,this.velocity.y=this.velocity.y+this.gravity.y*t,this.isDie||(this.node.angle=this.node.angle+50*t),this.node.y<-150&&(this.isDie||this.DataStore.currentRoom!=this.Config.ROOM_KIND.CLASSIC||this.emitEvent(s.UI_LAYER.ON_UPDATE_REMAINING),this.node.removeFromParent(!0)))},onDie:function(){this.emitEvent(s.UI_LAYER.ON_UPDATE_SCORE),this.emitEvent(s.EFFECT_LAYER.PLAY_EFFECT_BLOOD,this.node.getPosition()),this.isDie=!0,this.main.active=!1,this.half_1.active=!0,this.half_2.active=!0,this.half_1.runAction(cc.spawn(cc.moveBy(3,cc.v2(100,0)),cc.rotateBy(3,180))),this.half_2.runAction(cc.spawn(cc.moveBy(3,cc.v2(-100,0)),cc.rotateBy(3,-180)))},onCollisionEnter:function(t){}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber",Utils:"Utils"}],VirusLayer:[function(t,e,i){"use strict";cc._RF.push(e,"3bd6550HHtKK4lhtRWav6bI","VirusLayer");var s=t("EventCode"),n=t("Utils"),o=n.randomInt,c=n.randomFloat;cc.Class({extends:t("Subscriber"),properties:{listVirusPrefab:[cc.Prefab],bomPrefab:cc.Prefab},onLoad:function(){this._super(),this.initEvents(),this.listVirus=[]},initEvents:function(){this.node.registerEvent(s.GAME_LAYER.ON_INIT_VIRUS,this.createListVirus,this),this.node.registerEvent(s.GAME_LAYER.ON_CLEAR_ALL_VIRUS,this.clearAllVirus,this)},createListVirus:function(){var t=this;this.clearAllVirus(),this.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){if(!t.DataStore.isPaused){var e=o(1,t.DataStore.maxItemToLaunch());t.launch(e)}})).repeatForever())},launch:function(t){for(var e=this,i=0,s=function(t){var s=e.getRandomVirus();c(0,1)<e.DataStore.bombProbability()&&i<e.DataStore.maxBombToLaunch()&&(s=cc.instantiate(e.bomPrefab),i++),s.parent=e.node,e.listVirus.push(s);var n=c(0,.5);s.runAction(cc.sequence(cc.delayTime(n),cc.callFunc(function(){s.launchVirus()})))},n=0;n<t;n++)s()},getRandomVirus:function(){var t=o(0,this.listVirusPrefab.length-1);return cc.instantiate(this.listVirusPrefab[t])},clearAllVirus:function(){this.node.stopAllActions(),this.listVirus.forEach(function(t){t.stopAllActions(),t.removeFromParent(!0)}),this.listVirus.length=0}}),cc._RF.pop()},{EventCode:"EventCode",Subscriber:"Subscriber",Utils:"Utils"}],WebSoundPlayer:[function(t,e,i){"use strict";cc._RF.push(e,"08a14eDJR9N/b1S0PSX1HGf","WebSoundPlayer");var s={NONE:0,PLAYING:1},n=cc.Class({extends:t("SoundPlayer"),properties:{gameNode:{type:cc.Node,default:null}},ctor:function(){this.webSound=!1,this.musicInstance=null,this.isWebSoundEnable=cc.sys.isBrowser&&"undefined"!=typeof Howl,this.soundLoadCount=0,this.totalSound=0,this.isAllWebSoundLoaded=!1,this.loadSoundCompleteHdl=this.onWebSoundLoadComplete.bind(this),this.ccMusic=-1,this.musicOffset=0,this.musicVolume=1,this.effectVolume=1,this.isGameActive=!0,this.howlMap={},this.bgMusicId=-1},onLoad:function(){this.currentBGM=null,this._super(),this.musicVolume=this.MUSIC_VOLUME,this.effectVolume=this.SOUND_EFFECT_VOLUME,this.isWebSoundEnable&&(this.webSound=!0,this.loadWebSounds(this.gameNode||this.node,null)),cc.game.on(cc.game.EVENT_SHOW,this.onGameShow,this),cc.game.on(cc.game.EVENT_HIDE,this.onGameHide,this)},loadWebSounds:function(t,e){this.soundLoadCount=0,this.gameNode=t;var i=[],s={},n=[];for(var o in cc.loader._cache){var c=cc.loader._cache[o]._owner;c instanceof cc.AudioClip&&(s[c.url]||(i.push({uuid:c._uuid,name:c.name,src:c.url}),s[c.url]=!0,n.push(c._uuid)))}cc.loader.release(n),this.totalSound=i.length;for(var r=0;r<i.length;r++){var u=i[r],a=new Howl({src:[u.src],preload:!0});a.once("load",this.onWebSoundLoadComplete.bind(this)),this.howlMap[u.uuid]=a}t.on(cc.Node.EventType.TOUCH_START,this.startPlayWithUserGesture,this,!0)},onWebSoundLoadComplete:function(t){this.soundLoadCount++,this.soundLoadCount==this.totalSound&&(this.isAllWebSoundLoaded=!0,cc.audioEngine.stopAllEffects(),cc.audioEngine.stopMusic(),this.isEnableBGM&&(this.currentBGM?this.playMusic(this.currentBGM,!0,-1,this.musicOffset):this.playMusic(this.bgmMain,!0,-1,this.musicOffset)))},playHowl:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return e.loop&&t.loop(e.loop),e.volume&&t.volume(e.volume),e.offset&&t.seek(e.offset),i>=0?t.play(i):t.play()},onGameShow:function(){if(cc.log("WebSound: onGameShow"),this.isGameActive=!0,this.webSound)for(var t in this.isEnableBGM&&this.resumeMusic(),this.howlMap){var e=this.howlMap[t];e!=this.musicInstance&&(e._vorgVolume&&(e.volume(e._vorgVolume),delete e._vorgVolume))}},onGameHide:function(){if(cc.log("WebSound: onGameHide"),this.isGameActive=!1,this.webSound)for(var t in this.musicInstance&&cc.sys.os!=cc.sys.OS_IOS&&this.musicInstance.pause(),this.howlMap){var e=this.howlMap[t];e!=this.musicInstance&&(e._vorgVolume=e.volume(),e.volume(0))}},startPlayWithUserGesture:function(t){var e=this;this.isAllWebSoundLoaded&&(this.currentBGM||(this.currentBGM=this.bgmMain),this.currentBGM?(this.musicInstance&&this.musicInstance.stop(),this.gameNode.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){e.playMusic(e.currentBGM,!0,-1,e.musicOffset),e.musicInstance&&e.musicInstance.playing()&&e.gameNode.off(cc.Node.EventType.TOUCH_START,e.startPlayWithUserGesture,e,!0),!e.isEnableBGM&&e.musicInstance&&e.musicInstance.pause()})))):cc.log("WebSoundPlayer::startPlayWithUserGesture this.bgmMain is not initialized."))},start:function(){},setMusicVolume:function(t){this.musicVolume=t,this.isEnableBGM&&(this.webSound?this.musicInstance&&this.musicInstance.volume(t):cc.audioEngine.setMusicVolume(t))},setEffectsVolume:function(t){if(this.effectVolume=t,this.webSound)for(var e in this.howlMap){var i=this.howlMap[e];i!=this.musicInstance&&i.volume(t)}else cc.audioEngine.setEffectsVolume(t)},playMusic:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.musicVolume,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;i<0&&(i=this.musicVolume);try{this._playMusic(t,e,i,s)}catch(t){cc.log(t.toString())}},_playMusic:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.musicVolume,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;t&&(t.name||this.howlMap[t._uuid])?(cc.log("playMusic ==== "+t._uuid+" volume "+i),this.currentBGM=t,this.musicVolume=i,this.musicOffset=s,this.webSound?this.isAllWebSoundLoaded&&(this.musicInstance&&this.musicInstance.stop(),this.musicInstance=this.howlMap[t._uuid],this.musicInstance.loop(e),this.musicInstance.volume(i),this.bgMusicId=this.musicInstance.play(),this.isEnableBGM&&this.isGameActive||this.pauseMusic(),s>0&&this.musicInstance.seek(s)):(this.ccMusic=cc.audioEngine.playMusic(t,e),cc.sys.isBrowser?(cc.audioEngine.setMusicVolume(i),this.isEnableBGM||cc.audioEngine.pauseMusic()):this.isEnableBGM?cc.audioEngine.setMusicVolume(i):cc.audioEngine.setMusicVolume(.001),s>0&&cc.audioEngine.setCurrentTime(this.ccMusic,s))):cc.log("WebSoundPlayer::playMusic invalid audio",t)},stopMusic:function(){try{this._stopMusic()}catch(t){cc.log(t.toString())}},_stopMusic:function(){this.currentBGM=null,this.ccMusic=-1,this.webSound?this.musicInstance&&(this.musicInstance.stop(),this.bgMusicId=-1):cc.audioEngine.stopMusic()},pauseMusic:function(){try{this._pauseMusic()}catch(t){cc.log(t.toString())}},_pauseMusic:function(){this.webSound?this.musicInstance&&(cc.sys.os==cc.sys.OS_IOS?this.musicInstance.volume(.01):this.musicInstance.pause()):cc.audioEngine.pauseMusic()},resumeMusic:function(){try{this._resumeMusic()}catch(t){cc.log(t.toString())}},_resumeMusic:function(){if(this.isEnableBGM)if(this.webSound){if(!this.musicInstance||!this.currentBGM)return;var t;t=this.musicInstance.seek(),this.musicInstance.stop(this.bgMusicId),this.musicInstance=this.howlMap[this.currentBGM._uuid],this.bgMusicId=this.playHowl(this.musicInstance,{loop:!0,volume:this.MUSIC_VOLUME,offset:t})}else cc.audioEngine.resumeMusic(),cc.audioEngine.setMusicVolume(this.musicVolume)},stopEffect:function(t){try{this._stopEffect(t)}catch(t){cc.log(t.toString())}},_stopEffect:function(t){this.webSound?"number"!=typeof t&&t&&t.stop():cc.audioEngine.stopEffect(t)},stopAllEffects:function(){try{this._stopAllEffects()}catch(t){cc.log(t.toString())}},_stopAllEffects:function(){if(this.webSound)for(var t in this.howlMap){var e=this.howlMap[t];e!=this.musicInstance&&e.stop()}else{var i=0,s=!1;if(this.ccMusic>=0&&(i=cc.audioEngine.getCurrentTime(this.ccMusic),s=cc.audioEngine.isLoop(this.ccMusic),cc.audioEngine.getVolume(this.ccMusic)),cc.audioEngine.stopAllEffects(),this.ccMusic>=0&&this.currentBGM&&!cc.sys.isBrowser){var n=this.isEnableBGM?this.musicVolume:0;this.ccMusic=cc.audioEngine.playMusic(this.currentBGM,s),cc.audioEngine.setMusicVolume(n),cc.audioEngine.setCurrentTime(this.ccMusic,i)}}},playSFXClick:function(){if(this.sfxClick&&(this.sfxClick.name||this.howlMap[this.sfxClick._uuid])){if(this.isEnableSFX&&this.sfxClick){var t=void 0;return this.webSound?(t=this.howlMap[this.sfxClick._uuid]).play():t=cc.audioEngine.playEffect(this.sfxClick),t}}else cc.log("WebSoundPlayer::playSFXClick invalid sfxClick")},playEffect:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.effectVolume,s=null;try{s=this._playEffect(t,e,i)}catch(t){cc.log(t.toString())}return s},_playEffect:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.effectVolume;if(this.isGameActive)if(t&&(t.name||this.howlMap[t._uuid])){if(this.isEnableSFX){var s=null;return this.webSound?this.isAllWebSoundLoaded&&((s=this.howlMap[t._uuid]).loop(e),s.volume(i),s.play()):s=cc.audioEngine.playEffect(t,e),s}}else cc.log("WebSoundPlayer::playEffect invalid sfx")},playSFX:function(t){return this.playEffect(t)},playSound:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.SOUND_EFFECT_VOLUME,s=null;try{s=this._playSound(t,e,i)}catch(t){cc.log(t.toString())}return s},_playSound:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.SOUND_EFFECT_VOLUME;if(this.isGameActive)if(t&&(t.name||this.howlMap[t._uuid])){if(this.isEnableSFX){var s=null;return this.webSound?this.isAllWebSoundLoaded&&((s=this.howlMap[t._uuid]).loop(e),s.volume(i),s.play()):s=cc.audioEngine.play(t,e,i),s}}else cc.log("WebSoundPlayer::playSound invalid audio")},stopSound:function(t){try{this._stopSound(t)}catch(t){cc.log(t.toString())}},_stopSound:function(t){this.stopEffect(t)},stopAllAudio:function(){try{this._stopAllAudio()}catch(t){cc.log(t.toString())}},_stopAllAudio:function(){this.currentBGM=null,this.ccMusic=-1,this.webSound?(this.stopAllEffects(),this.musicInstance&&this.musicInstance.pause()):cc.audioEngine.stopAll()},sfxToggle:function(){this.setEffectEnable(!this.isEnableSFX)},setEffectEnable:function(t){this.isEnableSFX=t,this.node.gSlotDataStore&&(this.node.gSlotDataStore.isEnableSFX=this.isEnableSFX),cc.sys.localStorage.setItem(this.storageKeySFX,this.isEnableSFX),this.isEnableSFX||this.stopAllEffects()},bgmToggle:function(){this.setBgmEnable(!this.isEnableBGM)},setBgmEnable:function(t){this.isEnableBGM=t,this.node.gSlotDataStore&&(this.node.gSlotDataStore.isEnableBGM=this.isEnableBGM),cc.sys.localStorage.setItem(this.storageKeyBGM,this.isEnableBGM),this.isEnableBGM?this.currentBGM?this.resumeMusic():this.playMainBGM():this.pauseMusic()},setVolume:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return!(0!==t&&!t)&&(this.webSound?"number"!=typeof t&&t.volume(e):cc.audioEngine.setVolume(t,e),!0)},getVolume:function(t){return 0===t||t?this.webSound?"number"!=typeof t?t.volume():void 0:cc.audioEngine.getVolume(t,volume):0},getPlayState:function(t){if(0!==t&&!t)return s.NONE;var e=s.NONE;if(this.webSound)"number"!=typeof t&&t.playing()&&(e=s.PLAYING);else switch(cc.audioEngine.getState(t)){case cc.audioEngine.AudioState.PLAYING:e=s.PLAYING}return e},getMusicState:function(){var t=this.webSound?this.musicInstance:this.ccMusic;return this.getPlayState(t)},getDuration:function(t){return t?this.webSound?"number"!=typeof t?t.duration():void 0:cc.audioEngine.getDuration(t):0},onDestroy:function(){if(this.gameNode&&this.gameNode.off(cc.Node.EventType.TOUCH_START,this.startPlayWithUserGesture,this,!0),cc.game.off(cc.game.EVENT_SHOW,this.onGameShow,this),cc.game.off(cc.game.EVENT_HIDE,this.onGameHide,this),this.webSound)for(var t in this.howlMap)this.howlMap[t].unload()}});e.exports={SoundStateEnum:s,SoundStorageKeys:{ENABLE_BGM:"enableBackgroundMusic",ENABLE_SFX:"enableSound"},WebSoundPlayer:n},cc._RF.pop()},{SoundPlayer:"SoundPlayer"}]},{},["Config","DataStore","EventCode","LoadingScene","MainGameDirector","Observer","Subscriber","Utils","CutItem","CutLayer","EffectLayerBottom","EffectLayerTop","Game\bController","Remaining","Timer","UIController","VirusItem","VirusLayer","LobbyController","PausePopup","PopupController","PopupItem","SettingPopup","SummaryPopup","SoundController","SoundPlayer","WebSoundPlayer"]);